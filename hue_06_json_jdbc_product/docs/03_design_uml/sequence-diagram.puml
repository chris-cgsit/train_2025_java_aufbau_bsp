@startuml
title Produkt-Importer â€“ Sequenzdiagramm (ImportService.execute)
autonumber

actor User
participant ProductImporterApp as App
participant ConfigurationManager as ConfigMgr
participant ImportService as ImportSvc
participant ProductFileImporter as FileImporter
participant DatabaseConnectionFactory as ConnFactory
participant ProductRepository as Repo
database DB

User -> App: main(args)
App -> ConfigMgr: load(args)
ConfigMgr --> App: AppConfig

App -> ImportSvc: execute(config)

ImportSvc -> FileImporter: readProducts(config.inputFile)
FileImporter --> ImportSvc: List<Product>

ImportSvc -> ConnFactory: createConnection(config)
ConnFactory --> ImportSvc: Connection

ImportSvc -> DB: begin transaction\n(setAutoCommit(false))
ImportSvc -> Repo: insertAll(products)
Repo -> DB: INSERT ... (batch)
DB --> Repo: OK
Repo --> ImportSvc: void

alt success
  ImportSvc -> DB: commit
  ImportSvc --> App: OK
else error (z.B. SQL/Parsing)
  ImportSvc -> DB: rollback
  ImportSvc --> App: Exception/Fehlermeldung
end

@enduml

